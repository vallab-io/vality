ktor {
    deployment {
        port = 4000
        host = "localhost"
    }

    # Frontend URL (공개 구독 이메일 링크용)
    web {
        url = "https://vality.io"
    }
    
    application {
        modules = [ io.vality.ApplicationKt.module ]
    }
    
    # Database (JDBC for Exposed)
    database {
        url = "jdbc:postgresql://aws-1-ap-northeast-1.pooler.supabase.com:6543/postgres"
        username = "postgres.jbpimadgmvwiuoqpxfpd"
        password = "vAliTyio@25"
        driver = "org.postgresql.Driver"
        pool {
            maximumPoolSize = 10
            minimumIdle = 5
            connectionTimeout = 30000
            idleTimeout = 600000
            maxLifetime = 1800000
        }
    }
    
    # Flyway Migration
    # 마이그레이션 실행 여부 (기본값: false)
    # true로 설정하면 애플리케이션 시작 시 자동으로 마이그레이션 실행
    # 환경 변수 FLYWAY_RUN_MIGRATION으로도 오버라이드 가능
    flyway {
        runMigration = false
    }
    
    # JWT
    jwt {
        secret = "your-secret-key-change-in-production-min-256-bits"
        issuer = "vality"
        audience = "vality-api"
        realm = "vality"
    }
    
    # CORS
    cors {
        allowedOrigins = ["http://localhost:3000", "https://vality.io"]
    }
    
    # OAuth2 설정
    oauth {
        # Google OAuth2
        google {
            clientId = "187363549328-63co54d7suciup0u145m45lamc0piel7.apps.googleusercontent.com"
            clientSecret = "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"
        }
        
        # Apple OAuth2 (Sign in with Apple)
        apple {
            clientId = ${?APPLE_CLIENT_ID}
            clientId = "your-apple-client-id"
            teamId = ${?APPLE_TEAM_ID}
            teamId = "your-apple-team-id"
            keyId = ${?APPLE_KEY_ID}
            keyId = "your-apple-key-id"
            privateKey = ${?APPLE_PRIVATE_KEY}
            privateKey = "-----BEGIN PRIVATE KEY-----\nyour-apple-private-key\n-----END PRIVATE KEY-----"
        }
    }
    
    # AWS 설정
    aws {
        # 공통 리전
        region = "ap-northeast-2"

        # 이미지 Base URL (환경 변수에서 우선 읽고, 없으면 기본값 사용)
        resourceBaseUrl = "https://vality-resources.s3.ap-northeast-2.amazonaws.com"
        
        # S3 설정 (vality-s3-user)
        s3 {
            # 환경 변수에서 우선 읽고, 없으면 기본값 사용
            accessKeyId = "AKIAQE4235GAIIWMEVOO"
            secretAccessKey = "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"
            bucket = "vality-resources"
        }
        
        # SES 설정 (vality-ses-user)
        ses {
            # 환경 변수에서 우선 읽고, 없으면 기본값 사용
            accessKeyId = "AKIAQE4235GAPTUC27H5"
            secretAccessKey = "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"
            fromEmail = "noreply@vality.io"
            fromName = "Vality"
        }
    }
    
    # Lemon Squeezy 설정
    lemonSqueezy {
        # 웹훅 서명 검증용 시크릿 키
        # Lemon Squeezy 대시보드 > Settings > Webhooks에서 확인
        webhookSecret = "vality_ls_webhook_9f3k2d8s0a9f2j3l"
        
        # Starter 플랜 Variant ID
        # Lemon Squeezy 대시보드 > Products > Variants에서 확인
        starterVariantId = 1167390
        
        # Pro 플랜 Variant ID
        # Lemon Squeezy 대시보드 > Products > Variants에서 확인
        proVariantId = 1167391

        # Store ID (옵션, store-{id}.lemonsqueezy.com 형식 사용 시)
        storeId = "vality"

        # 체크아웃 Base URL (기본값: https://store.lemonsqueezy.com/checkout)
        checkoutBaseUrl = "https://vality.lemonsqueezy.com/checkout"
    }
}

